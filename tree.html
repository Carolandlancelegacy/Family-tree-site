<!DOCTYPE html>
<html>
<head>
  <title>Family Tree</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <h1>Family Tree Viewer</h1>
  <p id="placeholder">This is where your visual tree will appear.</p>

  <script>
    fetch('tree.json')
      .then(response => response.json())
      .then(data => {
        const dx = 200;  // more vertical space between nodes
        const dy = 220;  // wider spacing horizontally

        const width = 1000;

        const tree = d3.tree().nodeSize([dx, dy]);

        const diagonal = d3.linkHorizontal()
          .x(d => d.y)
          .y(d => d.x);

        const root = d3.hierarchy(data);
        root.x0 = 0;
        root.y0 = 0;
        tree(root);

        const svg = d3.select("body").append("svg")
          .attr("width", width)
          .attr("height", root.height * dx + 400)
          .attr("viewBox", [-dy / 3, -dx, width, 1000])
          .style("font", "14px sans-serif")
          .style("user-select", "none");

        const g = svg.append("g")
          .attr("transform", `translate(${dy / 3},${dx})`);

        const link = g.append("g")
          .attr("fill", "none")
          .attr("stroke", "#555")
          .attr("stroke-opacity", 0.6)
          .attr("stroke-width", 1.5)
          .selectAll("path")
          .data(root.links())
          .join("path")
          .attr("d", diagonal);

        const node = g.append("g")
          .attr("stroke-linejoin", "round")
          .attr("stroke-width", 3)
          .selectAll("g")
          .data(root.descendants())
          .join("g")
          .attr("transform", d => `translate(${d.y},${d.x})`);

        node.append("rect")
          .attr("fill", d => d.children ? "#555" : "#999")
          .attr("rx", 6)
          .attr("ry", 6)
          .attr("x", -60)
          .attr("y", -15)
          .attr("width", 120)
          .attr("height", 30);

        node.append("text")
          .attr("dy", "0.31em")
          .attr("x", 0)
          .attr("text-anchor", "middle")
          .attr("fill", "white")
          .text(d => d.data.name);
      });
  </script>
</body>
</html>
